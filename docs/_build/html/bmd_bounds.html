<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bmd_bounds module &mdash; PyTcpl 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PyTcpl
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">bmd_bounds module</a><ul>
<li><a class="reference internal" href="#bmd_bounds.bmd_bounds"><code class="docutils literal notranslate"><span class="pre">bmd_bounds()</span></code></a></li>
<li><a class="reference internal" href="#bmd_bounds.bmd_obj"><code class="docutils literal notranslate"><span class="pre">bmd_obj()</span></code></a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyTcpl</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">bmd_bounds module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/bmd_bounds.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-bmd_bounds">
<span id="bmd-bounds-module"></span><h1>bmd_bounds module<a class="headerlink" href="#module-bmd_bounds" title="Permalink to this heading"></a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="bmd_bounds.bmd_bounds">
<span class="sig-prename descclassname"><span class="pre">bmd_bounds.</span></span><span class="sig-name descname"><span class="pre">bmd_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onesidedp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which_bound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lower'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmd_bounds.html#bmd_bounds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmd_bounds.bmd_bounds" title="Permalink to this definition"></a></dt>
<dd><p>BMD Bounds</p>
<p>Uses maximum likelihood method to tune the upper and lower bounds on the BMD (BMDU, BMDL).</p>
<p>Takes in concentration response fit details and outputs a bmdu or bmdl, as desired.
If bmd is not finite, returns NA. If the objective function doesn’t change sign or
the root finding otherwise fails, it returns NA. These failures are not uncommon
since some curves just don’t reach the desired confidence level.</p>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>fit_method<span class="classifier">str</span></dt><dd><p>Fit method: “exp2”, “exp3”, “exp4”, “exp5”, “hill”, “gnls”, “poly1”, “poly2”, or “pow”.</p>
</dd>
<dt>bmr<span class="classifier">float</span></dt><dd><p>Benchmark response.</p>
</dd>
<dt>pars<span class="classifier">dict</span></dt><dd><p>Named vector of model parameters: a,b,tp,ga,p,la,q,er output by httrfit, and in that order.</p>
</dd>
<dt>conc<span class="classifier">array-like</span></dt><dd><p>Vector of concentrations (NOT in log units).</p>
</dd>
<dt>resp<span class="classifier">array-like</span></dt><dd><p>Vector of responses corresponding to given concentrations.</p>
</dd>
<dt>onesidedp<span class="classifier">float</span></dt><dd><p>The one-sided p-value. Default of .05 corresponds to 5 percentile BMDL, 95 percentile BMDU, and 90 percent CI.</p>
</dd>
<dt>bmd<span class="classifier">float, optional</span></dt><dd><p>Can optionally input the bmd when already known to avoid unnecessary calculation.</p>
</dd>
<dt>which.bound<span class="classifier">str, optional</span></dt><dd><p>Returns BMDU if which.bound = “upper”; returns BMDL if which.bound = “lower”.</p>
</dd>
</dl>
</section>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt>float or None</dt><dd><p>Returns either the BMDU or BMDL.</p>
</dd>
</dl>
</section>
<section id="examples">
<h2>Examples:<a class="headerlink" href="#examples" title="Permalink to this heading"></a></h2>
<p>conc = [0.03, 0.1, 0.3, 1, 3, 10, 30, 100]
resp = [0.1, -0.1, 0, 1.1, 1.9, 2, 2.1, 1.9]
pars = {‘tp’: 1.973356, ‘ga’: 0.9401224, ‘p’: 3.589397, ‘er’: -2.698579}
bmdbounds(fit_method=”hill”, bmr=0.5, pars=pars, conc=conc, resp=resp)
bmdbounds(fit_method=”hill”, bmr=0.5, pars=pars, conc=conc, resp=resp, which.bound=”upper”)</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmd_bounds.bmd_obj">
<span class="sig-prename descclassname"><span class="pre">bmd_bounds.</span></span><span class="sig-name descname"><span class="pre">bmd_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bmd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bmr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mll</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onesp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmd_bounds.html#bmd_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmd_bounds.bmd_obj" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Robin Bosshard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>